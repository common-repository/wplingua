jQuery(document).ready(function(s){let o=s("#wplng-translation-editor");function r(e){e.height(0),e.height(e[0].scrollHeight-4)}function d(){s("#wplng-modal-edit-container").hide(),s("#wplng-modal-edit-save").prop("disabled",!1),s("#wplng-modal-container").show(),t.onload="",t.now=""}function e(){0<s("#wplng-modal-container").scrollTop()?s("#wplng-scroll-to-top").fadeIn(400):s("#wplng-scroll-to-top").fadeOut(400)}function l(){n=!1,t={onload:a(),now:a()};let e=o.find(".wplng-edit-language textarea");e.off("keyup.textarea").on("keyup.textarea",function(){r(s(this))}),s(window).resize(function(){e.each(function(){r(s(this))})}),e.each(function(){r(s(this))}),o.find('.wplng-mark-as-reviewed input[type="checkbox"]').change(function(){var e=o.find("#wplng-translation-"+s(this).attr("wplng-lang"));e.removeClass("wplng-status-generated"),e.removeClass("wplng-status-reviewed"),e.removeClass("wplng-status-ungenerated"),this.checked?e.addClass("wplng-status-reviewed"):e.addClass("wplng-status-generated")}),o.find(".wplng-edit-language textarea").each(function(){o.find("#wplng_mark_as_reviewed_"+s(this).attr("lang")).prop("disabled",""==s(this).val().trim())}),o.find(".wplng-edit-language textarea").on("keyup paste",function(){var e=o.find("#wplng-translation-"+s(this).attr("lang")),n=o.find("#wplng_mark_as_reviewed_"+s(this).attr("lang"));e.removeClass("wplng-status-generated"),e.removeClass("wplng-status-reviewed"),e.removeClass("wplng-status-ungenerated"),""==s(this).val().trim()?(e.addClass("wplng-status-ungenerated"),n.prop("checked",!1),n.prop("disabled",!0)):(e.addClass("wplng-status-reviewed"),n.prop("checked",!0),n.prop("disabled",!1))}),o.find(".wplng-generate-spin").hide(),o.find(".wplng-generate").on("click",function(){var e,l,n,i;"disabled"!=s(this).attr("disabled")&&(e=o.find("#wplng-original-language").attr("wplng-lang"),l=o.find(this).attr("wplng-lang"),n=o.find("#wplng-source").html(),null!=e)&&null!=l&&null!=n&&(i="#wplng-translation-"+l,o.find(i+" .wplng-generate").attr("disabled",!0),o.find(i+" .wplng-generate-spin").show(),s.ajax({url:wplngLocalize.ajaxUrl,method:"POST",data:{action:"wplng_ajax_translation",text:n,language_source:e,language_target:l},success:function(e){var n,t,a;e.success?(s(n="#wplng_translation_"+l).val(e.data),""!=e.data&&(t=o.find("#wplng-translation-"+l),a=o.find("#wplng_mark_as_reviewed_"+l),t.removeClass("wplng-status-generated"),t.removeClass("wplng-status-reviewed"),t.removeClass("wplng-status-ungenerated"),t.addClass("wplng-status-reviewed"),a.prop("checked",!0),a.prop("disabled",!1)),r(s(n)),p(),s(i+" .wplng-generate-spin").hide(),setTimeout(function(){o.find(i+" .wplng-generate").attr("disabled",!1)},8e3)):(console.log("wpLingua - Error:"),console.log(e),o.find(i+" .wplng-generate-spin").removeClass("dashicons-update").removeClass("wplng-spin").addClass("dashicons-no"))},error:function(e){console.log("wpLingua - Error:"),console.log(e),o.find(i+" .wplng-generate-spin").removeClass("dashicons-update").removeClass("wplng-spin").addClass("dashicons-no")}}))}),o.find(".wplng-edit-language textarea, .wplng-edit-language input").on("change input propertychange",p),s("#submitpost [type=submit], #wplng-modal-edit-save").click(function(){n=!0}),s(window).on("beforeunload",function(){if(!n&&t.onload!=t.now)return confirm(wplngLocalize.message.exitPage)})}s("#toplevel_page_wplingua-settings").removeClass("wp-not-current-submenu").addClass("wp-has-current-submenu"),s("a.toplevel_page_wplingua-settings").addClass("wp-menu-open").addClass("wp-has-current-submenu"),e(),s("#wplng-modal-container").scroll(e),s("#wplng-scroll-to-top").click(function(){s("#wplng-modal-container").animate({scrollTop:0},800)}),s("#wplng-modal-edit-show-all").on("click",function(){s(this).hide(),o.find(".wplng-edit-language").show()});let n=!1,t={onload:a(),now:a()};function a(){let e="";return o.find(".wplng-edit-language textarea").each(function(){e+=s(this).val()}),o.find(".wplng-edit-language input[type=checkbox]").each(function(){e+=s(this).prop("checked")}),e}function p(){t.now=a(),t.onload==t.now?s("#wplng-modal-edit-save").prop("disabled",!0):s("#wplng-modal-edit-save").prop("disabled",!1)}function i(){s("#wplng-modal-edit-save").text(wplngLocalize.message.buttonSave),s("#wplng-modal-edit-save").prop("disabled",!0);let t=s(this).attr("data-wplng-post"),a=s("#wplng-modal-edit-post").attr("data-wplng-edit-template");a=a.replace("WPLNG_TRANSLATION_ID",t),s.ajax({url:wplngLocalize.ajaxUrl,method:"POST",data:{action:"wplng_ajax_edit_modal",post_id:t},success:function(e){var n;e.success?(n=function(e){let n=e;return n=(n=(n=(n=(n=n.replace(/&nbsp;/gi," ")).replace(/&amp;/gi,"&")).replace(/&quot;/gi,'"')).replace(/&lt;/gi,"<")).replace(/&gt;/gi,">")}((n=JSON.parse(e.data)).wplng_edit_html),o.html(n),s("#wplng-modal-edit-post").attr("href",a),s("#wplng-modal-edit-container").show(),s("#wplng-modal-container").hide(),s("#wplng-modal-edit-save").attr("data-wplng-post",t),1==o.find(".wplng-edit-language").length?s("#wplng-modal-edit-show-all").hide():s("#wplng-modal-edit-show-all").show(),l(),n=(n=".wplng-edit-language:not([wplng-lang=")+wplngLocalize.currentLanguage+"])",o.find(n).hide()):(console.log("wpLingua - Error:"),console.log(e))},error:function(e){console.log("wpLingua - Error:"),console.log(e)}})}function g(e,a){return s(s(e).toArray().sort(function(e,n){e=s(e).find(a).text(),n=s(n).find(a).text();let t=0;return e<n?t=-1:n<e&&(t=1),t}))}l(),s(".wplng-edit-link[data-wplng-post]").click(i),s("#wplng-modal-edit-return").click(function(){(t.onload==t.now||confirm(wplngLocalize.message.exitEditorModal))&&d()}),s("#wplng-modal-edit-save").click(function(){s("#wplng-modal-edit-save").text(wplngLocalize.message.buttonSaveInProgress);let a=s(this).text(),l=s(this).attr("data-wplng-post"),n={action:"wplng_ajax_save_modal",post_id:l,wplng_translation_meta_box_nonce:o.find("#wplng_translation_meta_box_nonce").val()},i=(o.find(".wplng-translation-textarea").each(function(){var e=s(this).attr("id");n[e]=s(this).val(),"wplng_translation_"+wplngLocalize.currentLanguage==e&&(a=s(this).val())}),1==s("#wplng_mark_as_reviewed_"+wplngLocalize.currentLanguage).prop("checked"));o.find(".wplng-mark-as-reviewed input[type=checkbox]").each(function(){n[s(this).attr("id")]=s(this).prop("checked")}),s.ajax({url:wplngLocalize.ajaxUrl,method:"POST",data:n,success:function(e){var n,t;e.success?(n=s("body.wplingua-editor .wplng-edit-link[data-wplng-post="+l+"]"),t=s("body.wplingua-list .wplng-modal-item[data-wplng-post="+l+"]"),n.text(a),t.find(".wplng-item-translation").text(a),i?(n.addClass("wplng-is-review"),t.addClass("wplng-is-review")):(n.removeClass("wplng-is-review"),t.removeClass("wplng-is-review")),d()):(console.log("wpLingua - Error:"),console.log(e))},error:function(e){console.log("wpLingua - Error:"),console.log(e)}})}),s("#wplng-filter-search, #wplng-filter-status").on("input",function(){let i=s("#wplng-filter-status").val(),o=s("#wplng-filter-search").val();o=o.trim().toLowerCase(),s(".wplng-modal-item").each(function(e){let n=s(this).find(".wplng-item-translation").html(),t=s(this).find(".wplng-item-source").html();var a,l;n=n.toLowerCase(),t=t.toLowerCase(),a=""==o||0<=n.indexOf(o)||0<=t.indexOf(o),l="all"==i||"reviewed"==i&&s(this).hasClass("wplng-is-review")||"unreviewed"==i&&!s(this).hasClass("wplng-is-review"),a&&l?s(this).show():s(this).hide()})}),s("#wplng-filter-order").on("input",function(){let e=s("#wplng-filter-order").val(),n=[],t="";switch(e){case"alphabetical-sources":n=g(".wplng-modal-item",".wplng-item-source");break;case"alphabetical-translations":n=g(".wplng-modal-item",".wplng-item-translation");break;default:n=function(e,t){return s(s(e).toArray().sort(function(e,n){return parseInt(e.getAttribute(t))-parseInt(n.getAttribute(t))}))}(".wplng-modal-item","data-wplng-order")}n.each(function(e){t+=s(this).prop("outerHTML")}),s("#wplng-modal-items").html(t),s("#wplng-modal-items").find(".wplng-edit-link[data-wplng-post]").click(i)})});//# sourceMappingURL=translation.js.map
